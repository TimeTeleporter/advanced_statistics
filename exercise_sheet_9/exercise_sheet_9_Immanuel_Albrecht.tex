\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{exercise\_sheet\_9\_Immanuel\_Albrecht}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{exercise-sheet-9---wine-tasting}{%
\section{Exercise sheet 9 - Wine
tasting}\label{exercise-sheet-9---wine-tasting}}

For this exercise, you will need to load the dataset (Wines2012) from
the rethinking package that we discussed already in the class.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nf}{library}\PY{p}{(}\PY{n}{rethinking}\PY{p}{)}
\PY{n+nf}{data}\PY{p}{(}\PY{n}{Wines2012}\PY{p}{)}
\PY{n}{d} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{Wines2012}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Lade nötiges Paket: rstan

Lade nötiges Paket: StanHeaders


rstan version 2.26.16 (Stan version 2.26.1)


For execution on a local, multicore CPU with excess RAM we recommend calling
options(mc.cores = parallel::detectCores()).
To avoid recompilation of unchanged Stan programs, we recommend calling
rstan\_options(auto\_write = TRUE)
For within-chain threading using `reduce\_sum()` or `map\_rect()` Stan functions,
change `threads\_per\_chain` option:
rstan\_options(threads\_per\_chain = 1)


Do not specify '-march=native' in 'LOCAL\_CPPFLAGS' or a Makevars file

Lade nötiges Paket: cmdstanr

This is cmdstanr version 0.5.3

- CmdStanR documentation and vignettes: mc-stan.org/cmdstanr

- CmdStan path: D:/Users/Immanuel/Documents/.cmdstan/cmdstan-2.31.0

- CmdStan version: 2.31.0


A newer version of CmdStan is available. See ?install\_cmdstan() to install it.
To disable this check set option or environment variable
CMDSTANR\_NO\_VER\_CHECK=TRUE.

Lade nötiges Paket: parallel

rethinking (Version 2.31)


Attache Paket: 'rethinking'


Das folgende Objekt ist maskiert 'package:rstan':

    stan


Das folgende Objekt ist maskiert 'package:stats':

    rstudent


    \end{Verbatim}

    This dataset comes from the judgment of Princeton, which was a wine
tasting event that took place in 2012 in Princeton (NJ, USA). The goal
was to compare French wines to the ones produced by the New Jersey wine
industry. This dataset contains the following variables that we will be
using:

\begin{itemize}
\tightlist
\item
  score: rating assigned by each judge to each wine.
\item
  wine: wine id
\item
  judge: judge name
\item
  flight: red or white wine
\item
  wine.amer: american or french wine
\item
  judge.amer: american or french (or belgian) judge
\end{itemize}

The goal is to model the score variable (standardise it to facilitate
the exercises below) based on the predictors listed above. Mention
clearly the priors you are using throughout the exercises.

    \hypertarget{exercise-1}{%
\subsection{Exercise 1}\label{exercise-1}}

Focus on the interaction between the variables judge and wine. Use
indices for these two variables, e.g.~judgeid \textless-
as.integer(d\$judge). Start by using a simple linear model to measure
the relationship between the score and the 9 judges and 20 wines. Use a
figure to summarise the model output. Is there any visible pattern
amongst the judges in the one hand and amongst the wines in the other
hand? Are there wines that consistently got low/high ratings? Are there
judges that are more severe than others?

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{as.integer}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge}\PY{p}{)}
\PY{c+c1}{\PYZsh{} d\PYZdl{}judgeid \PYZlt{}\PYZhy{} scale(d\PYZdl{}judgeid)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{as.integer}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine}\PY{p}{)}
\PY{c+c1}{\PYZsh{} d\PYZdl{}wineid \PYZlt{}\PYZhy{} scale(d\PYZdl{}wineid)}
\PY{n}{d.score.max} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{max}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score} \PY{o}{/} \PY{n}{d.score.max}
\PY{n}{d.score.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{as.integer}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flight}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m}{1}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nf}{plot}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid}\PY{p}{,} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{)}
\PY{n+nf}{plot}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid}\PY{p}{,} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{)}
\PY{n}{d}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    A data.frame: 180 × 9
\begin{tabular}{lllllllll}
 judge & flight & wine & score & wine.amer & judge.amer & judgeid & wineid & flightid\\
 <fct> & <fct> & <fct> & <dbl> & <int> & <int> & <int> & <int> & <dbl>\\
\hline
	 Jean-M Cardebat & white & A1 & 0.5128205 & 1 & 0 & 4 &  1 & 1\\
	 Jean-M Cardebat & white & B1 & 0.6666667 & 1 & 0 & 4 &  3 & 1\\
	 Jean-M Cardebat & white & C1 & 0.7179487 & 0 & 0 & 4 &  5 & 1\\
	 Jean-M Cardebat & white & D1 & 0.7692308 & 0 & 0 & 4 &  7 & 1\\
	 Jean-M Cardebat & white & E1 & 0.4102564 & 1 & 0 & 4 &  9 & 1\\
	 Jean-M Cardebat & white & F1 & 0.6666667 & 1 & 0 & 4 & 11 & 1\\
	 Jean-M Cardebat & white & G1 & 0.7692308 & 1 & 0 & 4 & 13 & 1\\
	 Jean-M Cardebat & white & H1 & 0.5641026 & 0 & 0 & 4 & 15 & 1\\
	 Jean-M Cardebat & white & I1 & 0.4615385 & 1 & 0 & 4 & 17 & 1\\
	 Jean-M Cardebat & white & J1 & 0.6153846 & 0 & 0 & 4 & 19 & 1\\
	 Tyler Colman    & white & A1 & 0.8205128 & 1 & 1 & 9 &  1 & 1\\
	 Tyler Colman    & white & B1 & 0.7179487 & 1 & 1 & 9 &  3 & 1\\
	 Tyler Colman    & white & C1 & 0.7179487 & 0 & 1 & 9 &  5 & 1\\
	 Tyler Colman    & white & D1 & 0.8205128 & 0 & 1 & 9 &  7 & 1\\
	 Tyler Colman    & white & E1 & 0.6153846 & 1 & 1 & 9 &  9 & 1\\
	 Tyler Colman    & white & F1 & 0.5641026 & 1 & 1 & 9 & 11 & 1\\
	 Tyler Colman    & white & G1 & 0.5641026 & 1 & 1 & 9 & 13 & 1\\
	 Tyler Colman    & white & H1 & 0.7179487 & 0 & 1 & 9 & 15 & 1\\
	 Tyler Colman    & white & I1 & 0.5641026 & 1 & 1 & 9 & 17 & 1\\
	 Tyler Colman    & white & J1 & 0.7179487 & 0 & 1 & 9 & 19 & 1\\
	 John Foy        & white & A1 & 0.8205128 & 1 & 1 & 5 &  1 & 1\\
	 John Foy        & white & B1 & 0.8717949 & 1 & 1 & 5 &  3 & 1\\
	 John Foy        & white & C1 & 0.8205128 & 0 & 1 & 5 &  5 & 1\\
	 John Foy        & white & D1 & 0.7692308 & 0 & 1 & 5 &  7 & 1\\
	 John Foy        & white & E1 & 0.7435897 & 1 & 1 & 5 &  9 & 1\\
	 John Foy        & white & F1 & 0.7435897 & 1 & 1 & 5 & 11 & 1\\
	 John Foy        & white & G1 & 0.8205128 & 1 & 1 & 5 & 13 & 1\\
	 John Foy        & white & H1 & 0.8717949 & 0 & 1 & 5 & 15 & 1\\
	 John Foy        & white & I1 & 0.7692308 & 1 & 1 & 5 & 17 & 1\\
	 John Foy        & white & J1 & 0.8974359 & 0 & 1 & 5 & 19 & 1\\
	 ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮ & ⋮\\
	 Daniele Meulder & red & A2 & 0.7179487 & 0 & 0 & 1 &  2 & 0\\
	 Daniele Meulder & red & B2 & 0.8205128 & 0 & 0 & 1 &  4 & 0\\
	 Daniele Meulder & red & C2 & 0.5641026 & 1 & 0 & 1 &  6 & 0\\
	 Daniele Meulder & red & D2 & 0.8205128 & 1 & 0 & 1 &  8 & 0\\
	 Daniele Meulder & red & E2 & 0.7179487 & 1 & 0 & 1 & 10 & 0\\
	 Daniele Meulder & red & F2 & 0.7692308 & 1 & 0 & 1 & 12 & 0\\
	 Daniele Meulder & red & G2 & 0.6666667 & 0 & 0 & 1 & 14 & 0\\
	 Daniele Meulder & red & H2 & 0.5641026 & 1 & 0 & 1 & 16 & 0\\
	 Daniele Meulder & red & I2 & 0.5128205 & 1 & 0 & 1 & 18 & 0\\
	 Daniele Meulder & red & J2 & 0.7692308 & 0 & 0 & 1 & 20 & 0\\
	 Jamal Rayyis    & red & A2 & 0.7692308 & 0 & 0 & 3 &  2 & 0\\
	 Jamal Rayyis    & red & B2 & 1.0000000 & 0 & 0 & 3 &  4 & 0\\
	 Jamal Rayyis    & red & C2 & 0.7179487 & 1 & 0 & 3 &  6 & 0\\
	 Jamal Rayyis    & red & D2 & 0.6153846 & 1 & 0 & 3 &  8 & 0\\
	 Jamal Rayyis    & red & E2 & 0.6666667 & 1 & 0 & 3 & 10 & 0\\
	 Jamal Rayyis    & red & F2 & 0.8205128 & 1 & 0 & 3 & 12 & 0\\
	 Jamal Rayyis    & red & G2 & 0.7435897 & 0 & 0 & 3 & 14 & 0\\
	 Jamal Rayyis    & red & H2 & 0.7692308 & 1 & 0 & 3 & 16 & 0\\
	 Jamal Rayyis    & red & I2 & 0.8205128 & 1 & 0 & 3 & 18 & 0\\
	 Jamal Rayyis    & red & J2 & 0.8205128 & 0 & 0 & 3 & 20 & 0\\
	 Francis Schott  & red & A2 & 0.9743590 & 0 & 1 & 2 &  2 & 0\\
	 Francis Schott  & red & B2 & 0.9230769 & 0 & 1 & 2 &  4 & 0\\
	 Francis Schott  & red & C2 & 0.4102564 & 1 & 1 & 2 &  6 & 0\\
	 Francis Schott  & red & D2 & 0.7692308 & 1 & 1 & 2 &  8 & 0\\
	 Francis Schott  & red & E2 & 0.7692308 & 1 & 1 & 2 & 10 & 0\\
	 Francis Schott  & red & F2 & 0.6153846 & 1 & 1 & 2 & 12 & 0\\
	 Francis Schott  & red & G2 & 0.7692308 & 0 & 1 & 2 & 14 & 0\\
	 Francis Schott  & red & H2 & 0.8205128 & 1 & 1 & 2 & 16 & 0\\
	 Francis Schott  & red & I2 & 0.3589744 & 1 & 1 & 2 & 18 & 0\\
	 Francis Schott  & red & J2 & 0.8717949 & 0 & 1 & 2 & 20 & 0\\
\end{tabular}


    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_5_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{map}\PY{p}{(}
	\PY{n+nf}{alist}\PY{p}{(}
		\PY{n}{score} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{sigma}\PY{p}{)}\PY{p}{,}
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{a} \PY{o}{+} \PY{n}{bj} \PY{o}{*} \PY{n}{judgeid} \PY{o}{+} \PY{n}{bw} \PY{o}{*} \PY{n}{wineid} \PY{o}{+} \PY{n}{bjw} \PY{o}{*} \PY{n}{judgeid} \PY{o}{*} \PY{n}{wineid}\PY{p}{,}
		\PY{n}{a} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{)}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{,}
		\PY{n}{bj} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{,}
		\PY{n}{bw} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{,}
		\PY{n}{bjw} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{10}\PY{p}{)}\PY{p}{,}
		\PY{n}{sigma} \PY{o}{\PYZti{}} \PY{n+nf}{dunif}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{20}\PY{p}{)}
	\PY{p}{)}\PY{p}{,}
	\PY{n}{data} \PY{o}{=} \PY{n}{d}
\PY{p}{)}

\PY{n}{post} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{extract.samples}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\PY{n}{mu.link} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{function}\PY{p}{(}\PY{n}{judgeid}\PY{p}{,} \PY{n}{wineid}\PY{p}{)} \PY{n}{post}\PY{o}{\PYZdl{}}\PY{n}{a} \PY{o}{+} \PY{n}{post}\PY{o}{\PYZdl{}}\PY{n}{bj} \PY{o}{*} \PY{n}{judgeid} \PY{o}{+} \PY{n}{post}\PY{o}{\PYZdl{}}\PY{n}{bw} \PY{o}{*} \PY{n}{wineid} \PY{o}{+} \PY{n}{post}\PY{o}{\PYZdl{}}\PY{n}{bjw} \PY{o}{*} \PY{n}{judgeid} \PY{o}{*} \PY{n}{wineid}
\PY{n}{mu.link.judgeid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{function}\PY{p}{(}\PY{n}{judgeid}\PY{p}{)} \PY{n+nf}{mu.link}\PY{p}{(}\PY{n}{judgeid}\PY{p}{,} \PY{n}{wineid} \PY{o}{=} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid}\PY{p}{)}\PY{p}{)}
\PY{n}{mu.link.wineid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{function}\PY{p}{(}\PY{n}{wineid}\PY{p}{)} \PY{n+nf}{mu.link}\PY{p}{(}\PY{n}{judgeid} \PY{o}{=} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid}\PY{p}{)}\PY{p}{,} \PY{n}{wineid}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{judgeid.seq} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{seq}\PY{p}{(}\PY{n}{from} \PY{o}{=} \PY{n+nf}{min}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid}\PY{p}{)}\PY{p}{,} \PY{n}{to} \PY{o}{=} \PY{n+nf}{max}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid}\PY{p}{)}\PY{p}{,} \PY{n}{by} \PY{o}{=} \PY{l+m}{0.01}\PY{p}{)}
\PY{n}{wineid.seq} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{seq}\PY{p}{(}\PY{n}{from} \PY{o}{=} \PY{n+nf}{min}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid}\PY{p}{)}\PY{p}{,} \PY{n}{to} \PY{o}{=} \PY{n+nf}{max}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid}\PY{p}{)}\PY{p}{,} \PY{n}{by} \PY{o}{=} \PY{l+m}{0.01}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} This function plots a given model with shades}
\PY{n}{plot\PYZus{}with\PYZus{}shade\PYZus{}judgeid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{function}\PY{p}{(}\PY{n}{output}\PY{p}{,} \PY{n}{mu.link}\PY{p}{)} \PY{p}{\PYZob{}}
\PY{c+c1}{\PYZsh{} For each weight value we calculate a 91 percent credible interval}
\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{sapply}\PY{p}{(}\PY{n}{judgeid.seq}\PY{p}{,} \PY{n}{mu.link}\PY{p}{)}
\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)}
\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob} \PY{o}{=} \PY{l+m}{0.91}\PY{p}{)}

\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{judgeid}\PY{p}{,} \PY{n}{d}\PY{p}{)}
\PY{n+nf}{lines}\PY{p}{(}\PY{n}{judgeid.seq}\PY{p}{,} \PY{n}{mu.mean}\PY{p}{)}
\PY{n+nf}{shade}\PY{p}{(}\PY{n}{mu.HPDI}\PY{p}{,} \PY{n}{judgeid.seq}\PY{p}{)}

\PY{c+c1}{\PYZsh{} We calculate the 91 percent credible interval of the height variables by taking into account the uncertainty of the slope and the standard deviation}
\PY{n}{sim.score} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{sim}\PY{p}{(}\PY{n}{output}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n+nf}{list}\PY{p}{(}\PY{n}{judgeid} \PY{o}{=} \PY{n}{judgeid.seq}\PY{p}{,} \PY{n}{wineid} \PY{o}{=} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wineid}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n}{score.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{sim.score}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob} \PY{o}{=} \PY{l+m}{0.91}\PY{p}{)}
\PY{n+nf}{shade}\PY{p}{(}\PY{n}{score.HPDI}\PY{p}{,} \PY{n}{judgeid.seq}\PY{p}{)}
\PY{p}{\PYZcb{}}

\PY{n}{plot\PYZus{}with\PYZus{}shade\PYZus{}wineid} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{function}\PY{p}{(}\PY{n}{output}\PY{p}{,} \PY{n}{mu.link}\PY{p}{)} \PY{p}{\PYZob{}}
\PY{c+c1}{\PYZsh{} For each weight value we calculate a 91 percent credible interval}
\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{sapply}\PY{p}{(}\PY{n}{wineid.seq}\PY{p}{,} \PY{n}{mu.link}\PY{p}{)}
\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)}
\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob} \PY{o}{=} \PY{l+m}{0.91}\PY{p}{)}

\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{wineid}\PY{p}{,} \PY{n}{d}\PY{p}{)}
\PY{n+nf}{lines}\PY{p}{(}\PY{n}{wineid.seq}\PY{p}{,} \PY{n}{mu.mean}\PY{p}{)}
\PY{n+nf}{shade}\PY{p}{(}\PY{n}{mu.HPDI}\PY{p}{,} \PY{n}{wineid.seq}\PY{p}{)}

\PY{c+c1}{\PYZsh{} We calculate the 91 percent credible interval of the height variables by taking into account the uncertainty of the slope and the standard deviation}
\PY{n}{sim.score} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{sim}\PY{p}{(}\PY{n}{output}\PY{p}{,} \PY{n}{data} \PY{o}{=} \PY{n+nf}{list}\PY{p}{(}\PY{n}{wineid} \PY{o}{=} \PY{n}{wineid.seq}\PY{p}{,} \PY{n}{judgeid} \PY{o}{=} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judgeid}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n}{score.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{sim.score}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob} \PY{o}{=} \PY{l+m}{0.91}\PY{p}{)}
\PY{n+nf}{shade}\PY{p}{(}\PY{n}{score.HPDI}\PY{p}{,} \PY{n}{wineid.seq}\PY{p}{)}
\PY{p}{\PYZcb{}}

\PY{n+nf}{plot\PYZus{}with\PYZus{}shade\PYZus{}judgeid}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{mu.link.judgeid}\PY{p}{)}
\PY{n+nf}{plot\PYZus{}with\PYZus{}shade\PYZus{}wineid}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{mu.link.wineid}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_8_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    This was a dud. The linear model obviously doesnt tell us anything. We
see that some wines have a little better scores than others, and some
judges give on average better scores than others. For the useless model
we used quite harmless priors that nearly dont restrict the parameters.

    \hypertarget{exercise-2}{%
\subsection{Exercise 2}\label{exercise-2}}

Focus now on the flight, wine.amer and judge.amer variables. Build a
linear model (without interactions for the time being) to model the
score form these three predictors. Is there an identifiable bias between
judge and wine regions? Is one flight favoured over the other? Compute
posterior differences to aid in your analysis of the results.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model1} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{map}\PY{p}{(}
	\PY{n+nf}{alist}\PY{p}{(}
		\PY{n}{score} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{sigma}\PY{p}{)}\PY{p}{,}
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{afw} \PY{o}{*} \PY{n}{flightid} \PY{o}{+} \PY{n}{afr} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{flightid}\PY{p}{)} \PY{o}{+} \PY{n}{awa} \PY{o}{*} \PY{n}{wine.amer} \PY{o}{+} \PY{n}{awe} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{wine.amer}\PY{p}{)} \PY{o}{+} \PY{n}{aja} \PY{o}{*} \PY{n}{judge.amer} \PY{o}{+} \PY{n}{aje} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{judge.amer}\PY{p}{)}\PY{p}{,}
		\PY{n}{afw} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{afr} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{awa} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{awe} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{aja} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{aje} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.2}\PY{p}{)}\PY{p}{,}
		\PY{n}{sigma} \PY{o}{\PYZti{}} \PY{n+nf}{dunif}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{2}\PY{p}{)}
	\PY{p}{)}\PY{p}{,}
	\PY{n}{data} \PY{o}{=} \PY{n}{d}
\PY{p}{)}

\PY{n+nf}{plot}\PY{p}{(}\PY{n+nf}{summary}\PY{p}{(}\PY{n}{model1}\PY{p}{)}\PY{p}{)}
\PY{n+nf}{grid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_11_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Okay, the exercise is worded so weirdly, that ill just answer the second
part, if there is identifiable bias of judge, wine region and if one
flight is favoured over another. We create a dataset for all possible
combinations of judges, wines and flights

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aaw} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aar} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}\PY{p}{)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aew} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aer} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}\PY{p}{)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eaw} \PY{o}{\PYZlt{}\PYZhy{}} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{ear} \PY{o}{\PYZlt{}\PYZhy{}} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}\PY{p}{)}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eew} \PY{o}{\PYZlt{}\PYZhy{}} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}
\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eer} \PY{o}{\PYZlt{}\PYZhy{}} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid}\PY{p}{)}

\PY{n}{means} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{c}\PY{p}{(}\PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aaw} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aar} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aew} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{aer} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eaw} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{ear} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eew} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nf}{mean}\PY{p}{(}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{score}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{eer} \PY{o}{==} \PY{l+m}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{names} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{aaw\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{aar\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{aew\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{aer\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{eaw\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ear\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{eew\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{eer\PYZdq{}}\PY{p}{)}

\PY{n+nf}{barplot}\PY{p}{(}\PY{n}{means}\PY{p}{,} \PY{n}{names.arg} \PY{o}{=} \PY{n}{names}\PY{p}{,} \PY{n}{ylim} \PY{o}{=} \PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0.65}\PY{p}{,} \PY{l+m}{0.78}\PY{p}{)}\PY{p}{,} \PY{n}{xpd} \PY{o}{=} \PY{k+kc}{FALSE}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We see that american judges like european wine more than american one.
European red has better scores than european white and american white
has better scores than american red. Red american wine has the lowerst
scores over all and red european has the best scores. Europeans like
white american more than white european, and it is inverted for american
judges.

    Here we see the same results as above.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} make a plot window with three panels in a single row }
\PY{n+nf}{par}\PY{p}{(}\PY{n}{mfrow}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{3}\PY{p}{,}\PY{l+m}{4}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} 3 row, 4 columns }
\PY{c+c1}{\PYZsh{} loop over values of water.c and plot predictions }
\PY{n}{my\PYZus{}seq} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{w} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{f} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{==} \PY{n}{w} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid} \PY{o}{==} \PY{n}{f}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{judge.amer}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{wine =\PYZdq{}}\PY{p}{,} \PY{n}{w}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, flight =\PYZdq{}}\PY{p}{,} \PY{n}{f}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model1} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{judge.amer} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{wine.amer} \PY{o}{=} \PY{n}{w}\PY{p}{,} \PY{n}{flightid} \PY{o}{=} \PY{n}{f}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{j} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{f} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{==} \PY{n}{j} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid} \PY{o}{==} \PY{n}{f}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{wine.amer}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge =\PYZdq{}}\PY{p}{,} \PY{n}{j}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, flight =\PYZdq{}}\PY{p}{,} \PY{n}{f}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{wine\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model1} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{wine.amer} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{judge.amer} \PY{o}{=} \PY{n}{j}\PY{p}{,} \PY{n}{flightid} \PY{o}{=} \PY{n}{f}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{j} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{w} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{==} \PY{n}{j} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{==} \PY{n}{w}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{flightid}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge =\PYZdq{}}\PY{p}{,} \PY{n}{j}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, wine =\PYZdq{}}\PY{p}{,} \PY{n}{w}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{flight\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model1} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{flightid} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{wine.amer} \PY{o}{=} \PY{n}{w}\PY{p}{,} \PY{n}{judge.amer} \PY{o}{=} \PY{n}{j}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{exercise-3}{%
\subsection{Exercise 3}\label{exercise-3}}

Build a model that includes the three different interactions between the
three variables of Exercise 2. Explain your choice of priors compared to
Exercise 2 and detail how the interaction model affect the parameters.
As in the class, use the link command to compute the predicted scores
versus flight, wine region and judge nationality. In the interaction
model, is there a preference (or not!) between judge's nationality and
wine region? Discuss all other possible outcomes.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model2} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{map}\PY{p}{(}
	\PY{n+nf}{alist}\PY{p}{(}
		\PY{n}{score} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{n}{sigma}\PY{p}{)}\PY{p}{,}
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{paaw} \PY{o}{*} \PY{n}{judge.amer} \PY{o}{*} \PY{n}{wine.amer} \PY{o}{*} \PY{n}{flightid} \PY{o}{+}
		\PY{n}{paar} \PY{o}{*} \PY{n}{judge.amer} \PY{o}{*} \PY{n}{wine.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{flightid}\PY{p}{)} \PY{o}{+}
		\PY{n}{paew} \PY{o}{*} \PY{n}{judge.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{n}{flightid} \PY{o}{+}
		\PY{n}{paer} \PY{o}{*} \PY{n}{judge.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{flightid}\PY{p}{)} \PY{o}{+}
		\PY{n}{peaw} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{n}{wine.amer} \PY{o}{*} \PY{n}{flightid} \PY{o}{+}
		\PY{n}{pear} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{n}{wine.amer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{flightid}\PY{p}{)} \PY{o}{+}
		\PY{n}{peew} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{n}{flightid} \PY{o}{+}
		\PY{n}{peer} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{judge.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{wine.amer}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{l+m}{1} \PY{o}{\PYZhy{}} \PY{n}{flightid}\PY{p}{)}\PY{p}{,}
		\PY{n}{paaw} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{paar} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{paew} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{paer} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{peaw} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{pear} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{peew} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{peer} \PY{o}{\PYZti{}} \PY{n+nf}{dnorm}\PY{p}{(}\PY{n}{d.score.mean}\PY{p}{,} \PY{l+m}{0.3}\PY{p}{)}\PY{p}{,}
		\PY{n}{sigma} \PY{o}{\PYZti{}} \PY{n+nf}{dunif}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{2}\PY{p}{)}
	\PY{p}{)}\PY{p}{,}
	\PY{n}{data} \PY{o}{=} \PY{n}{d}
\PY{p}{)}

\PY{n+nf}{plot}\PY{p}{(}\PY{n+nf}{summary}\PY{p}{(}\PY{n}{model2}\PY{p}{)}\PY{p}{)}
\PY{n+nf}{grid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} make a plot window with three panels in a single row }
\PY{n+nf}{par}\PY{p}{(}\PY{n}{mfrow}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{3}\PY{p}{,}\PY{l+m}{4}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} 3 row, 4 columns }
\PY{c+c1}{\PYZsh{} loop over values of water.c and plot predictions }
\PY{n}{my\PYZus{}seq} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{w} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{f} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{==} \PY{n}{w} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid} \PY{o}{==} \PY{n}{f}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{judge.amer}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{wine =\PYZdq{}}\PY{p}{,} \PY{n}{w}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, flight =\PYZdq{}}\PY{p}{,} \PY{n}{f}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model2} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{judge.amer} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{wine.amer} \PY{o}{=} \PY{n}{w}\PY{p}{,} \PY{n}{flightid} \PY{o}{=} \PY{n}{f}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{j} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{f} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{==} \PY{n}{j} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{flightid} \PY{o}{==} \PY{n}{f}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{wine.amer}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge =\PYZdq{}}\PY{p}{,} \PY{n}{j}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, flight =\PYZdq{}}\PY{p}{,} \PY{n}{f}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{wine\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model2} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{wine.amer} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{judge.amer} \PY{o}{=} \PY{n}{j}\PY{p}{,} \PY{n}{flightid} \PY{o}{=} \PY{n}{f}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\PY{n+nf}{for }\PY{p}{(}\PY{n}{j} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}} 
	\PY{n+nf}{for }\PY{p}{(}\PY{n}{w} \PY{n}{in} \PY{n}{my\PYZus{}seq}\PY{p}{)} \PY{p}{\PYZob{}}
		\PY{n}{dt} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n}{d}\PY{p}{[}\PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{judge.amer} \PY{o}{==} \PY{n}{j} \PY{o}{\PYZam{}} \PY{n}{d}\PY{o}{\PYZdl{}}\PY{n}{wine.amer} \PY{o}{==} \PY{n}{w}\PY{p}{,} \PY{p}{]} 
		\PY{n+nf}{plot}\PY{p}{(}\PY{n}{score} \PY{o}{\PYZti{}} \PY{n}{flightid}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{dt}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{n}{rangi2}\PY{p}{,} 
		\PY{n}{main}\PY{o}{=}\PY{n+nf}{paste}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{judge =\PYZdq{}}\PY{p}{,} \PY{n}{j}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{, wine =\PYZdq{}}\PY{p}{,} \PY{n}{w}\PY{p}{)}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} \PY{n}{ylim}\PY{o}{=}\PY{n+nf}{c}\PY{p}{(}\PY{l+m}{0}\PY{p}{,} \PY{l+m}{1}\PY{p}{)}\PY{p}{,} 
		\PY{n}{xlab}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{flight\PYZdq{}}\PY{p}{)} 
		\PY{n}{mu} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{link}\PY{p}{(}\PY{n}{model2} \PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n+nf}{list}\PY{p}{(}\PY{n}{flightid} \PY{o}{=} \PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{wine.amer} \PY{o}{=} \PY{n}{w}\PY{p}{,} \PY{n}{judge.amer} \PY{o}{=} \PY{n}{j}\PY{p}{)}\PY{p}{)} 
		\PY{n}{mu.mean} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{mean}\PY{p}{)} 
		\PY{n}{mu.HPDI} \PY{o}{\PYZlt{}\PYZhy{}} \PY{n+nf}{apply}\PY{p}{(}\PY{n}{mu}\PY{p}{,} \PY{l+m}{2}\PY{p}{,} \PY{n}{HPDI}\PY{p}{,} \PY{n}{prob}\PY{o}{=}\PY{l+m}{0.91}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.mean} \PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{1}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)} 
		\PY{n+nf}{lines}\PY{p}{(}\PY{n}{my\PYZus{}seq}\PY{p}{,} \PY{n}{mu.HPDI}\PY{p}{[}\PY{l+m}{2}\PY{p}{,}\PY{p}{]}\PY{p}{,} \PY{n}{lty}\PY{o}{=}\PY{l+m}{2}\PY{p}{)}
	\PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{exercise_sheet_9_Immanuel_Albrecht_files/exercise_sheet_9_Immanuel_Albrecht_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As discovered above, we see that the american judges prefer european
white wine and europeans prefer american white wine. For red wine both
nationalities prefer the european red wine.

As for the priors, I always used the same priors for all models.


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
